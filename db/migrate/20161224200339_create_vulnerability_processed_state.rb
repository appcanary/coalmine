class CreateVulnerabilityProcessedState < ActiveRecord::Migration
  def change
    create_table :vulnerability_processed_states do |t|
      t.references :vulnerability, index: true, foreign_key_key: true
      t.boolean :processed, default: false, null: false

      t.timestamps null: false
    end
    VulnerabilityProcessedState.create(
      Vulnerability.pluck(:id).map { |id| { :vulnerability_id => id } }
    )
  end
end
