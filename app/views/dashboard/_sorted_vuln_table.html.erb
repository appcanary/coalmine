<table class="vulnerability-wrapper" cellpadding="0" cellspacing="0">
  <tr>
    <td>

      <table class="vulnerability-table" cellpadding="0" cellspacing="0" width="100%" style="padding-bottom: 10px">
        <thead>
          <th>
            priority
          </th>
          <th>
            vulnerability
          </th>
          <th>
            disclosed at
          </th>
        </thead>
        <% sorted_vulns.each do |vuln, pkgs| %>
          <tr class="vulnerability">
            <td width="20%" class="package-vuln-version">
              <%= vuln.criticality %>
            </td>
            <td width="60%" >
              <%= link_to vuln.title, vuln_url(vuln) %>
            </td>

            <td width="20%"  class="package-upgrade-to">
              <%= vuln.reported_at.try(:strftime, "%Y-%m-%d") || "unknown" %>
            </td>
          </tr>
          <tr>
            <td>
              &nbsp;
            </td>
            <td colspan=2>
              <p><b>packages:</b><br/>
              <% plist = pkgs[0..3].map(&:name).uniq %>
              <%= plist.join(", ") %>
                <% if plist.size > 4 %>
                  and <%= pkgs.size - 4 %> others.
                <% end %>

              </p>
            </td>
          </tr>
          <tr class="break"><td></td><td></td><td></td></tr>
        <% end %>
      </table>
    </td>
  </tr>
</table>

