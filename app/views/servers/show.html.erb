<%= render :partial => "shared/heading" %>

<section>
  <div class="server-info">
    <table class="table">
      <thead>
        <th>
          hostname
        </th>
        <th>
          address
        </th>
        <th>
          last heartbeat
        </th>
        <th>
          uname
        </th>
        <th>
          tags
        </th>
      </thead>
      <tbody>
        <tr>
          <td> 
            <%= @serverpres.display_name %>
          </td>
          <td>
            <%= @serverpres.ip %>
          </td>
          <td>
            <%= "#{time_ago_in_words_or_never @serverpres.last_heartbeat_at} ago" %>
          </td>
          <td>
            <%= @serverpres.uname %>
          </td>
          <td>
            <%= @serverpres.tags.join(", ") %>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>


<section>
  <div class="server-apps">
    <% if @serverpres.bundles.any? %>
      <span class="tabletitle"><h4>Apps and dependencies</h4> <%= link_to "Export to CSV", server_path(@serverpres, format: "csv"), class: "btn btn-default" %></span>
      <table class="table apps">
        <% @serverpres.bundles.each do |bundlepres| %>
          <tr>
            <%= render :partial => "apps/list", :locals => { :bundlepres => bundlepres } %>
          </tr>
        <% end %>
      </table>

    <% else %>
      <h3>Hey! We don't seem to be monitoring any apps.</h3>
      <p> 
        Please consult the 
        <%= link_to "server docs page", new_server_path %>
        for instructions. You're probably just slightly misconfigured.
        If you run into trouble, click the feedback button above.
      </p>
    <% end %>
  </div>
</section>

