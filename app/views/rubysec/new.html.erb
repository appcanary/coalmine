<div id="rubysec">
  <%= render :partial => "header" %> 

  <section>
    <div class="new-vuln">
      <h2>Report a new vulnerability</h2>
      <p>Hey! Thanks for taking the time to do this. Your submission helps the community. All submissions to this website are ultimately vetted on the <a href="https://github.com/rubysec/ruby-advisory-db">GitHub repository</a>.</p>
      <h4>Reporting a vulnerability is a simple 2 step process.</h4>
      <ol>
        <li> Disclose the flaw to the gem author.<br/>Please be polite! Open source maintainers are usually unpaid volunteers, and everyone deserves a little courtesy.</li>
        <li>Fill out this form:</li>
      </ol>
      <br/>

      <%= form_for RubysecAdvisoryAdapter.new, :url => "", :html => {:class => "form-horizontal"} do |f| %>
        <div class="form-group required">
          <%= f.label :gem, :class => "control-label" %>
          <div class="form-field">
            <%= f.text_field :gem, :class => "form-control" %>
            <span class="help-block">The name of the gem, as seen in <a href="http://rubygems.org">Rubygems</a>.</span>
          </div>
        </div>

        <div class="form-group required">
          <%= f.label :date, :class => "control-label"  %>
          <div class="form-field">

            <%= f.date_field :date, :class => "form-control" %>
            <span class="help-block">The date this vulnerability was disclosed to the library author or community.</span>
          </div>
        </div>


        <div class="form-group required">
          <%= f.label :url, "URL", :class => "control-label"  %>
          <div class="form-field">

            <%= f.text_field :url, :class => "form-control" %>
            <span class="help-block">A link to a blog post, mailing list, github issue or commit, etc that describes this vulnerability.</span>
          </div>
        </div>

        <div class="form-group">
          <%= f.label :cve, "CVE", :class => "control-label"  %>
          <div class="form-field">

            <%= f.text_field :cve, :class => "form-control" %>
            <span class="help-block">Have you been assigned a unique CVE identifier? If you haven't, we'll get you one. </span>
          </div>
        </div>


        <div class="form-group required">
          <%= f.label :title, :class => "control-label"  %>
          <div class="form-field">

            <%= f.text_field :title, :class => "form-control", :placeholder => "i.e. XSS in [name of gem]" %>
            <span class="help-block">A short sentence: what happened in what gem?</span>
          </div>
        </div>

        <div class="form-group required">
          <%= f.label :description, :class => "control-label"  %>
          <div class="form-field">

            <%= f.text_area :description, :class => "form-control", :placeholder => "i.e. A flaw in how [name of gem] sanitizes user input may allow an attacker to insert maliciously crafted html and javascript." %>
            <span class="help-block">One or two paragraphs describing the issue. A good description explains what the flaw is, and why the reader should care. A <i>great</i> description provides more context and possible workarounds.</span>
          </div>
        </div>


        <div class="form-group versions">
          <%= f.label :unaffected_versions, :class => "control-label"  %>
          <div class="form-field">

            <%= f.text_area :unaffected_versions, :class => "form-control fixed-width", :placeholder => "> 1.2.3\n>= 1.2.4\n< 2.3.4\n<= 2.3.3\n~> 2.2.2" %>
            <span class="help-block">Are there versions of this gem that are unaffected by the vulnerability?<br/><br/> Please provide line separated Gem <a href="http://ruby-doc.org/stdlib-2.3.0/libdoc/rubygems/rdoc/Gem/Requirement.html">version requirements</a>. Use any operator as appropriate, including the <a href="https://robots.thoughtbot.com/rubys-pessimistic-operator">pessimistic one</a>.</span>
          </div>
        </div>

        <div class="form-group versions">
          <%= f.label :patched_versions, :class => "control-label"  %>
          <div class="form-field">

            <%= f.text_area :patched_versions, :class => "form-control fixed-width", :placeholder => "> 1.2.3\n>= 1.2.4\n< 2.3.4\n<= 2.3.3\n~> 2.2.2" %>
            <span class="help-block">Has the library released any patches?<br/><br/> Please provide line separated Gem <a href="http://ruby-doc.org/stdlib-2.3.0/libdoc/rubygems/rdoc/Gem/Requirement.html">version requirements</a>. Use any operator as appropriate, including the <a href="https://robots.thoughtbot.com/rubys-pessimistic-operator">pessimistic one</a>.</span>
          </div>
        </div>


        <div class="form-group required">
          <%= f.label :email, "Your email", :class => "control-label"  %>
          <div class="form-field">

            <%= f.email_field :patched_versions, :class => "form-control", :placeholder => "jane@example.com" %>
            <span class="help-block">We might have to contact you in case things are unclear.</span>
          </div>
        </div>

        <div class="form-group">
          <div class="col-sm-offset-3 col-sm-10">

            <%= f.submit "Preview", :class => "btn btn-lg btn-primary" %>
          </div>
        </div>

      <% end %>
    </div>

  </section>
</div>
