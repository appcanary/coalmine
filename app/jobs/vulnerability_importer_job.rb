class VulnerabilityImporterJob < CronJob
  @queue = "vulnhandling"
  INTERVAL = 1.hour

  def run(args)
    VulnerabilityImporter::IMPORTERS.each do |k|
      log "Beginning #{k}"
      res, errors = VulnerabilityImporter.new(k::PLATFORM, k::SOURCE).import
      log "Done with #{k}"
 
      # todo: sentry?
      if errors.present?
        log errors, :error
      end
    end
  end
end
